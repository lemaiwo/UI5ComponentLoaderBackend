"use strict";                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
sap.ui.define(["be/wl/zcomploaderlib/objects/BaseState", "../model/Scenario"], function (BaseState, Scenario) {                                                                                                                                                
  "use strict";                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
  var ConfigState = BaseState.extend("be.wl.CompLoaderApp.state.ConfigState", {                                                                                                                                                                                
    constructor: function constructor(oService, compData, comp) {                                                                                                                                                                                              
      //data used for the view                                                                                                                                                                                                                                 
      this.data = {                                                                                                                                                                                                                                            
        scenario: new Scenario(compData)                                                                                                                                                                                                                       
      };                                                                                                                                                                                                                                                       
      this.ConfigService = oService.config;                                                                                                                                                                                                                    
      this.comp = comp;                                                                                                                                                                                                                                        
      BaseState.call(this);                                                                                                                                                                                                                                    
    },                                                                                                                                                                                                                                                         
    getConfigService: function getConfigService() {                                                                                                                                                                                                            
      return this.ConfigService;                                                                                                                                                                                                                               
    },                                                                                                                                                                                                                                                         
    getConfig: function getConfig() {                                                                                                                                                                                                                          
      var _this = this;                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
      if (this.getProperty("scenario").hasComponents()) {                                                                                                                                                                                                      
        return Promise.resolve(this.getProperty("scenario"));                                                                                                                                                                                                  
      }                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
      return this.getConfigService().getConfig(this.getProperty("scenario")).then(function (resp) {                                                                                                                                                            
        _this.getProperty("scenario").setComponents(resp.data.results);                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
        return _this.getProperty("scenario");                                                                                                                                                                                                                  
      }); //.then((scenario) => Promise.all(scenario.components.map((comp) => scenario.getUIComponent(comp.getLevel()))));                                                                                                                                     
    },                                                                                                                                                                                                                                                         
    getUIComponent: function getUIComponent(level) {                                                                                                                                                                                                           
      var _this2 = this;                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
      return this.getConfig().then(function () {                                                                                                                                                                                                               
        return _this2.getProperty("scenario").getUIComponent(level);                                                                                                                                                                                           
      });                                                                                                                                                                                                                                                      
    }                                                                                                                                                                                                                                                          
  });                                                                                                                                                                                                                                                          
  return ConfigState;                                                                                                                                                                                                                                          
});                                                                                                                                                                                                                                                            