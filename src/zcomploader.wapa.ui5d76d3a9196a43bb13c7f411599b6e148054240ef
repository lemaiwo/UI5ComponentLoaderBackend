"use strict";                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
sap.ui.define(["be/wl/zcomploaderlib/objects/BaseObject", "./Component"], function (BaseObject, Component) {                                                                                                                                                   
  "use strict";                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
  return BaseObject.extend("be.wl.CompLoaderApp.model.Scenario", {                                                                                                                                                                                             
    constructor: function constructor(data) {                                                                                                                                                                                                                  
      BaseObject.call(this, data);                                                                                                                                                                                                                             
      this.id = data.scenario;                                                                                                                                                                                                                                 
      this.startupParameters = data.startupParameters;                                                                                                                                                                                                         
      this.components = [];                                                                                                                                                                                                                                    
    },                                                                                                                                                                                                                                                         
    setComponents: function setComponents(components) {                                                                                                                                                                                                        
      this.components = components.map(function (component) {                                                                                                                                                                                                  
        return new Component(component);                                                                                                                                                                                                                       
      });                                                                                                                                                                                                                                                      
    },                                                                                                                                                                                                                                                         
    setTitle: function setTitle(title) {                                                                                                                                                                                                                       
      this.title = title;                                                                                                                                                                                                                                      
    },                                                                                                                                                                                                                                                         
    addComponent: function addComponent(component) {                                                                                                                                                                                                           
      this.components.push(new Component(component));                                                                                                                                                                                                          
    },                                                                                                                                                                                                                                                         
    getNextLevel: function getNextLevel(level) {                                                                                                                                                                                                               
      var nextlevel = ++level;                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
      if (nextlevel <= this.components.length) {                                                                                                                                                                                                               
        return nextlevel;                                                                                                                                                                                                                                      
      }                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
      return false;                                                                                                                                                                                                                                            
    },                                                                                                                                                                                                                                                         
    getPreviousLevel: function getPreviousLevel(level) {                                                                                                                                                                                                       
      var nextlevel = --level;                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
      if (nextlevel > 0) {                                                                                                                                                                                                                                     
        return nextlevel;                                                                                                                                                                                                                                      
      }                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
      return false;                                                                                                                                                                                                                                            
    },                                                                                                                                                                                                                                                         
    hasComponents: function hasComponents() {                                                                                                                                                                                                                  
      return this.components && Array.isArray(this.components) && this.components.length > 0;                                                                                                                                                                  
    },                                                                                                                                                                                                                                                         
    getComponent: function getComponent(level) {                                                                                                                                                                                                               
      return this.components.find(function (component) {                                                                                                                                                                                                       
        return component.getLevel() == level;                                                                                                                                                                                                                  
      });                                                                                                                                                                                                                                                      
    },                                                                                                                                                                                                                                                         
    getUIComponentData: function getUIComponentData(level) {                                                                                                                                                                                                   
      var data;                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
      if (this.getPreviousComponent(level)) {                                                                                                                                                                                                                  
        data = this.getPreviousComponent(level).getData();                                                                                                                                                                                                     
      }                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
      return data;                                                                                                                                                                                                                                             
    },                                                                                                                                                                                                                                                         
    getUIComponent: function getUIComponent(level) {                                                                                                                                                                                                           
      return this.getComponent(level).getUIComponent({                                                                                                                                                                                                         
        data: this.getUIComponentData(level),                                                                                                                                                                                                                  
        level: level,                                                                                                                                                                                                                                          
        startupParameters: this.startupParameters,                                                                                                                                                                                                             
        scenario: this.getJSON()                                                                                                                                                                                                                               
      });                                                                                                                                                                                                                                                      
    },                                                                                                                                                                                                                                                         
    updateUIComponent: function updateUIComponent(level) {                                                                                                                                                                                                     
      return this.getComponent(level).updateUIComponentInput({                                                                                                                                                                                                 
        data: this.getUIComponentData(level),                                                                                                                                                                                                                  
        level: level,                                                                                                                                                                                                                                          
        scenario: this.getJSON()                                                                                                                                                                                                                               
      });                                                                                                                                                                                                                                                      
    },                                                                                                                                                                                                                                                         
    updateNextUIComponent: function updateNextUIComponent(level) {                                                                                                                                                                                             
      var nextLevel = this.getNextComponent(level).getLevel();                                                                                                                                                                                                 
      return this.updateUIComponent(nextLevel);                                                                                                                                                                                                                
    },                                                                                                                                                                                                                                                         
    getNextComponent: function getNextComponent(level) {                                                                                                                                                                                                       
      var nextlevel = this.getNextLevel(level);                                                                                                                                                                                                                
      return nextlevel && this.getComponent(nextlevel);                                                                                                                                                                                                        
    },                                                                                                                                                                                                                                                         
    getPreviousComponent: function getPreviousComponent(level) {                                                                                                                                                                                               
      var prevlevel = this.getPreviousLevel(level);                                                                                                                                                                                                            
      return prevlevel && this.getComponent(prevlevel);                                                                                                                                                                                                        
    },                                                                                                                                                                                                                                                         
    getComponentIdByLevel: function getComponentIdByLevel(level) {                                                                                                                                                                                             
      return this.getComponent(level).getComponentId();                                                                                                                                                                                                        
    },                                                                                                                                                                                                                                                         
    getRouteByLevel: function getRouteByLevel(level) {                                                                                                                                                                                                         
      return this.getComponent(level).getView();                                                                                                                                                                                                               
    },                                                                                                                                                                                                                                                         
    getNextComponentRoute: function getNextComponentRoute(level) {                                                                                                                                                                                             
      var nextlevel = this.getNextLevel(level);                                                                                                                                                                                                                
                                                                                                                                                                                                                                                               
      if (nextlevel < this.components.length) {                                                                                                                                                                                                                
        return this.getRouteByLevel(nextlevel);                                                                                                                                                                                                                
      }                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
      return false;                                                                                                                                                                                                                                            
    },                                                                                                                                                                                                                                                         
    getPreviousComponentRoute: function getPreviousComponentRoute(level) {                                                                                                                                                                                     
      var prevlevel = this.getPreviousLevel(level);                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
      if (prevlevel < this.components.length) {                                                                                                                                                                                                                
        return this.getRouteByLevel(prevlevel);                                                                                                                                                                                                                
      }                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
      return false;                                                                                                                                                                                                                                            
    },                                                                                                                                                                                                                                                         
    getComponents: function getComponents() {                                                                                                                                                                                                                  
      return this.components;                                                                                                                                                                                                                                  
    },                                                                                                                                                                                                                                                         
    getJSON: function getJSON() {                                                                                                                                                                                                                              
      var scenario = this.getJSONObject(["id", "type"]);                                                                                                                                                                                                       
      scenario.components = this.getComponents().map(function (component) {                                                                                                                                                                                    
        return component.getJSON();                                                                                                                                                                                                                            
      });                                                                                                                                                                                                                                                      
      return scenario;                                                                                                                                                                                                                                         
    }                                                                                                                                                                                                                                                          
  });                                                                                                                                                                                                                                                          
});                                                                                                                                                                                                                                                            